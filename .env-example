# Example environment variables for docker-compose.yaml
# Coolify auto-generates SERVICE_* variables, so only customize these if needed

# Required after first deployment (get network name from Coolify dashboard)
DOCKER_RUNNER_NETWORKS=your-generated-network-name

# Registry username (password is auto-generated by Coolify as SERVICE_PASSWORD_REGISTRY)
REGISTRY_USERNAME=trigger

# ============================================
# BACKUP CONFIGURATION (Optional)
# Set BACKUP_ENABLED=true to enable automatic backups
# ============================================

# Enable backups (set to "true" to enable)
BACKUP_ENABLED=false

# S3-Compatible Storage (Required when backups are enabled)
BACKUP_S3_ENDPOINT=https://s3.amazonaws.com
BACKUP_S3_BUCKET=my-trigger-backups
BACKUP_S3_ACCESS_KEY_ID=your-access-key
BACKUP_S3_SECRET_ACCESS_KEY=your-secret-key
BACKUP_S3_REGION=us-east-1

# PostgreSQL Backup Settings (Optional - defaults shown)
# BACKUP_POSTGRES_SCHEDULE=0 2 * * *
# BACKUP_POSTGRES_KEEP_DAYS=60

# Redis Backup Settings (Optional - defaults shown)
# BACKUP_REDIS_SCHEDULE=0 3 * * *
# BACKUP_REDIS_KEEP_DAYS=60

# Backups are stored at: s3://{BUCKET}/{DOCKER_RUNNER_NETWORKS}/postgres/ and /redis/

# ============================================
# BATCH QUEUE TUNING
# Prevents stuck batches from leaked concurrency tokens
# See docs/batch-queue-stuck-fix.md for details
# ============================================
# BATCH_CONCURRENCY_LIMIT_DEFAULT=10
# BATCH_QUEUE_CONSUMER_COUNT=5
# BATCH_QUEUE_CONSUMER_INTERVAL_MS=100
# BATCH_QUEUE_SHARD_COUNT=2

# ============================================================
# CLICKHOUSE TUNING
# FINAL query optimizations are enabled by default for 1000+ runs
# ============================================================
# The docker-compose.yaml includes optimized ClickHouse settings:
# - max_final_threads=16 (parallelizes FINAL merge)
# - do_not_merge_across_partitions_select_final=1 (7x faster)
# - optimize_move_to_prewhere_if_final=1 (9x faster)
# These reduce query times from 900-1200ms to <100ms for 1000+ runs